{"ast":null,"code":"import _regeneratorRuntime from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{followAPI,getUsers,unfollowAPI,usersAPI}from\"../api/api\";export var CHANGE_FOLLOW_STATUS='CHANGE-FOLLOW-STATUS';export var SET_USERS='SET-USERS';export var SET_CURRENT_PAGE='SET-CURRENT-PAGE';export var SET_TOTAL_USERS_COUNT='SET-TOTAL-USERS-COUNT';export var TOGGLE_IS_FETCHING='TOGGLE-IS-FETCHING';export var TOGGLE_IS_FOLLOWING_IN_PROGRESS='TOGGLE-IS-FOLLOWING-IN-PROGRESS';var initialState={users:[],pageSize:5,totalUsersCount:0,currentPage:1,isFetching:false,isFollowingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case CHANGE_FOLLOW_STATUS:{var stateCopy=_objectSpread(_objectSpread({},state),{},{users:state.users.map(function(u){if(u.id===action.userID){return _objectSpread(_objectSpread({},u),{},{followed:!u.followed});}return u;})},state.users.location);return stateCopy;}case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:_toConsumableArray(action.users)});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});}case SET_TOTAL_USERS_COUNT:{return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalUsersCount});}case TOGGLE_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});}case TOGGLE_IS_FOLLOWING_IN_PROGRESS:{return _objectSpread(_objectSpread({},state),{},{isFollowingInProgress:action.isFetching?[].concat(_toConsumableArray(state.isFollowingInProgress),[action.userID]):state.isFollowingInProgress.filter(function(id){return id!==action.userID;})});}default:return state;}};export var followChangeAC=function followChangeAC(userID){return{type:CHANGE_FOLLOW_STATUS,userID:userID};};export var setUsersAC=function setUsersAC(users){return{type:SET_USERS,users:users};};export var setCurrentPageAC=function setCurrentPageAC(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCountAC=function setTotalUsersCountAC(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,totalUsersCount:totalUsersCount};};export var toggleIsFetchingAC=function toggleIsFetchingAC(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleIsFollowingInProgress=function toggleIsFollowingInProgress(isFetching,userID){return{type:TOGGLE_IS_FOLLOWING_IN_PROGRESS,isFetching:isFetching,userID:userID};};export var getUsersThunkCreator=function getUsersThunkCreator(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:debugger;dispatch(toggleIsFetchingAC(true));_context.next=4;return usersAPI.getUsers(currentPage,pageSize);case 4:data=_context.sent;dispatch(setUsersAC(data.items));dispatch(setTotalUsersCountAC(data.totalCount));dispatch(setCurrentPageAC(currentPage));dispatch(toggleIsFetchingAC(false));case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};var followFlowFunction=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch,func,userID){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleIsFollowingInProgress(true,userID));_context2.next=3;return func(userID);case 3:data=_context2.sent;if(data.resultCode===0){dispatch(followChangeAC(userID));}dispatch(toggleIsFollowingInProgress(false,userID));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function followFlowFunction(_x2,_x3,_x4){return _ref2.apply(this,arguments);};}();export var followThunkCreator=function followThunkCreator(userID){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:followFlowFunction(dispatch,usersAPI.followAPI,userID);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x5){return _ref3.apply(this,arguments);};}();};export var unfollowThunkCreator=function unfollowThunkCreator(userID){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:followFlowFunction(dispatch,usersAPI.unfollowAPI,userID);case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6){return _ref4.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"sources":["D:/react-projects/01-first-project/first-app/src/redux/users-reducer.js"],"names":["followAPI","getUsers","unfollowAPI","usersAPI","CHANGE_FOLLOW_STATUS","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_IN_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","isFollowingInProgress","usersReducer","state","action","type","stateCopy","map","u","id","userID","followed","location","filter","followChangeAC","setUsersAC","setCurrentPageAC","setTotalUsersCountAC","toggleIsFetchingAC","toggleIsFollowingInProgress","getUsersThunkCreator","dispatch","data","items","totalCount","followFlowFunction","func","resultCode","followThunkCreator","unfollowThunkCreator"],"mappings":"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","sourcesContent":["import {followAPI, getUsers, unfollowAPI, usersAPI} from \"../api/api\";\r\n\r\nexport const CHANGE_FOLLOW_STATUS = 'CHANGE-FOLLOW-STATUS';\r\nexport const SET_USERS = 'SET-USERS';\r\nexport const SET_CURRENT_PAGE = 'SET-CURRENT-PAGE';\r\nexport const SET_TOTAL_USERS_COUNT = 'SET-TOTAL-USERS-COUNT'\r\nexport const TOGGLE_IS_FETCHING = 'TOGGLE-IS-FETCHING'\r\nexport const TOGGLE_IS_FOLLOWING_IN_PROGRESS = 'TOGGLE-IS-FOLLOWING-IN-PROGRESS'\r\n\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 5,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFetching: false,\r\n    isFollowingInProgress: []\r\n}\r\n\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case CHANGE_FOLLOW_STATUS: {\r\n\r\n            let stateCopy = {\r\n                ...state,\r\n                users: state.users.map(u => {\r\n                    if (u.id === action.userID) {\r\n                        return {...u, followed: !u.followed}\r\n                    }\r\n                    return u;\r\n                }),\r\n                ...state.users.location\r\n            }\r\n            return stateCopy;\r\n        }\r\n        case SET_USERS: {\r\n\r\n            return {...state, users: [...action.users]}\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage};\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalUsersCount: action.totalUsersCount}\r\n        }\r\n        case TOGGLE_IS_FETCHING: {\r\n            return {...state, isFetching: action.isFetching}\r\n        }\r\n        case TOGGLE_IS_FOLLOWING_IN_PROGRESS: {\r\n            return {\r\n                ...state,\r\n                isFollowingInProgress: action.isFetching\r\n                    ? [...state.isFollowingInProgress, action.userID]\r\n                    : state.isFollowingInProgress.filter(id => id !== action.userID)\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const followChangeAC = (userID) => ({type: CHANGE_FOLLOW_STATUS, userID})\r\nexport const setUsersAC = (users) => ({type: SET_USERS, users})\r\nexport const setCurrentPageAC = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport const setTotalUsersCountAC = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, totalUsersCount})\r\nexport const toggleIsFetchingAC = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\r\nexport const toggleIsFollowingInProgress = (isFetching, userID) => ({\r\n    type: TOGGLE_IS_FOLLOWING_IN_PROGRESS,\r\n    isFetching,\r\n    userID\r\n})\r\n\r\n\r\nexport const getUsersThunkCreator = (currentPage, pageSize) => {\r\n    return async (dispatch) => {\r\n        debugger\r\n        dispatch(toggleIsFetchingAC(true));\r\n        let data = await usersAPI.getUsers(currentPage, pageSize);\r\n        dispatch(setUsersAC(data.items));\r\n        dispatch(setTotalUsersCountAC(data.totalCount));\r\n        dispatch(setCurrentPageAC(currentPage));\r\n        dispatch(toggleIsFetchingAC(false));\r\n    }\r\n}\r\n\r\nlet followFlowFunction = async (dispatch,func, userID) => {\r\n        dispatch(toggleIsFollowingInProgress(true, userID));\r\n        let data = await func(userID)\r\n        if (data.resultCode === 0) {\r\n            dispatch(followChangeAC(userID))\r\n\r\n        }\r\n        dispatch(toggleIsFollowingInProgress(false, userID));\r\n\r\n}\r\n\r\nexport const followThunkCreator = (userID) => {\r\n    return async (dispatch) =>{\r\n    followFlowFunction(dispatch,usersAPI.followAPI, userID)}\r\n}\r\n\r\nexport const unfollowThunkCreator = (userID) => {\r\n    return async (dispatch) =>{\r\n        followFlowFunction(dispatch,usersAPI.unfollowAPI, userID)}\r\n}\r\n\r\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}