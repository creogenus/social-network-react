{"ast":null,"code":"import { authAPI, securityAPI } from \"../api/api\";\nimport { stopSubmit } from \"redux-form\";\nimport { Redirect } from \"react-router-dom\";\nexport const SET_AUTH_USER_DATA = 'SET-AUTH-USER-DATA';\nlet initialState = {\n  userID: null,\n  email: null,\n  login: null,\n  isAuth: false\n};\n\nlet authReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_AUTH_USER_DATA:\n      {\n        return { ...state,\n          ...action.data,\n          isAuth: action.isAuth\n        };\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport const setAuthUserData = (userID, email, login, isAuth) => ({\n  type: SET_AUTH_USER_DATA,\n  data: {\n    userID,\n    email,\n    login\n  },\n  isAuth\n});\nexport const setAuthUserThunkCreator = () => async dispatch => {\n  {\n    let response = await authAPI.setAuthorizedProfile();\n\n    if (response.data.resultCode === 0) {\n      let {\n        id,\n        login,\n        email\n      } = response.data.data;\n      dispatch(setAuthUserData(id, email, login, true));\n    }\n  }\n};\nexport const loginThunkCreator = (email, password, rememberMe) => async dispatch => {\n  let response = await authAPI.login(email, password, rememberMe);\n  if (response.data.resultCode === 0) dispatch(setAuthUserThunkCreator());else {\n    let message = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\";\n    dispatch(stopSubmit(\"login\", {\n      _error: message\n    }));\n  }\n};\nexport const getCaptchaUrl = () => async dispatch => {\n  let response = await securityAPI.getCaptchaURL();\n  const captchaUrl = response.data.url;\n};\nexport const logoutThunkCreator = () => {\n  return async dispatch => {\n    let response = await authAPI.logout();\n    dispatch(setAuthUserData(null, null, null, false));\n  };\n};\nexport default authReducer;","map":{"version":3,"sources":["D:/react-projects/01-first-project/first-app/src/redux/auth-reducer.js"],"names":["authAPI","securityAPI","stopSubmit","Redirect","SET_AUTH_USER_DATA","initialState","userID","email","login","isAuth","authReducer","state","action","type","data","setAuthUserData","setAuthUserThunkCreator","dispatch","response","setAuthorizedProfile","resultCode","id","loginThunkCreator","password","rememberMe","message","messages","length","_error","getCaptchaUrl","getCaptchaURL","captchaUrl","url","logoutThunkCreator","logout"],"mappings":"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","sourcesContent":["import {authAPI, securityAPI} from \"../api/api\";\r\nimport {stopSubmit} from \"redux-form\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nexport const SET_AUTH_USER_DATA = 'SET-AUTH-USER-DATA'\r\n\r\n\r\nlet initialState = {\r\n    userID: null,\r\n    email: null,\r\n    login: null,\r\n    isAuth: false\r\n}\r\n\r\nlet authReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_AUTH_USER_DATA: {\r\n            return {\r\n                ...state,\r\n                ...action.data,\r\n                isAuth: action.isAuth\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setAuthUserData = (userID, email, login, isAuth) => ({\r\n    type: SET_AUTH_USER_DATA,\r\n    data: {userID, email, login},\r\n    isAuth\r\n})\r\nexport const setAuthUserThunkCreator = () => async (dispatch) => {\r\n    {\r\n        let response = await authAPI.setAuthorizedProfile()\r\n        if (response.data.resultCode === 0) {\r\n            let {id, login, email} = response.data.data;\r\n            dispatch(setAuthUserData(id, email, login, true));\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport const loginThunkCreator = (email, password, rememberMe) => async (dispatch) => {\r\n    let response = await authAPI.login(email, password, rememberMe)\r\n    if (response.data.resultCode === 0) dispatch(setAuthUserThunkCreator())\r\n    else {\r\n        let message = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\";\r\n        dispatch(stopSubmit(\"login\", {_error: message}));\r\n    }\r\n\r\n}\r\n\r\nexport const getCaptchaUrl= () => async (dispatch) => {\r\n    let response = await securityAPI.getCaptchaURL();\r\n    const captchaUrl = response.data.url;\r\n\r\n}\r\nexport const logoutThunkCreator = () => {\r\n    return async (dispatch) => {\r\n        let response = await authAPI.logout()\r\n        dispatch(setAuthUserData(null, null, null, false))\r\n    }\r\n}\r\n\r\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}