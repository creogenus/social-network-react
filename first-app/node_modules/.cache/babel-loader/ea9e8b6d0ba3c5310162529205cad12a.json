{"ast":null,"code":"import _regeneratorRuntime from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"D:/react-projects/01-first-project/first-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{authAPI}from\"../api/api\";import{stopSubmit}from\"redux-form\";import{Redirect}from\"react-router-dom\";export var SET_AUTH_USER_DATA='SET-AUTH-USER-DATA';var initialState={userID:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_AUTH_USER_DATA:{return _objectSpread(_objectSpread(_objectSpread({},state),action.data),{},{isAuth:action.isAuth});}default:return state;}};export var setAuthUserData=function setAuthUserData(userID,email,login,isAuth){return{type:SET_AUTH_USER_DATA,data:{userID:userID,email:email,login:login},isAuth:isAuth};};export var setAuthUserThunkCreator=function setAuthUserThunkCreator(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,id,login,email;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.setAuthorizedProfile();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,login=_response$data$data.login,email=_response$data$data.email;dispatch(setAuthUserData(id,email,login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loginThunkCreator=function loginThunkCreator(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0)dispatch(setAuthUserThunkCreator());else{message=response.data.messages.length>0?response.data.messages[0]:\"Some error\";dispatch(stopSubmit(\"login\",{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logoutThunkCreator=function logoutThunkCreator(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;dispatch(setAuthUserData(null,null,null,false));case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["D:/react-projects/01-first-project/first-app/src/redux/auth-reducer.js"],"names":["authAPI","stopSubmit","Redirect","SET_AUTH_USER_DATA","initialState","userID","email","login","isAuth","authReducer","state","action","type","data","setAuthUserData","setAuthUserThunkCreator","dispatch","setAuthorizedProfile","response","resultCode","id","loginThunkCreator","password","rememberMe","message","messages","length","_error","logoutThunkCreator","logout"],"mappings":"qeAAA,OAAQA,OAAR,KAAsB,YAAtB,CACA,OAAQC,UAAR,KAAyB,YAAzB,CACA,OAAQC,QAAR,KAAuB,kBAAvB,CAEA,MAAO,IAAMC,CAAAA,kBAAkB,CAAG,oBAA3B,CAGP,GAAIC,CAAAA,YAAY,CAAG,CACfC,MAAM,CAAE,IADO,CAEfC,KAAK,CAAE,IAFQ,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAOA,GAAIC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAChD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKT,CAAAA,kBAAL,CAAyB,CACrB,oDACOO,KADP,EAEOC,MAAM,CAACE,IAFd,MAGIL,MAAM,CAAEG,MAAM,CAACH,MAHnB,GAKH,CACD,QACI,MAAOE,CAAAA,KAAP,CATR,CAWH,CAZD,CAcA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAAmC,CAC9DI,IAAI,CAAET,kBADwD,CAE9DU,IAAI,CAAE,CAACR,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAFwD,CAG9DC,MAAM,CAANA,MAH8D,CAAnC,EAAxB,CAKP,MAAO,IAAMO,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,kGAAM,iBAAOC,QAAP,wLAEhBhB,CAAAA,OAAO,CAACiB,oBAAR,EAFgB,QAEjCC,QAFiC,eAGrC,GAAIA,QAAQ,CAACL,IAAT,CAAcM,UAAd,GAA6B,CAAjC,CAAoC,qBACPD,QAAQ,CAACL,IAAT,CAAcA,IADP,CAC3BO,EAD2B,qBAC3BA,EAD2B,CACvBb,KADuB,qBACvBA,KADuB,CAChBD,KADgB,qBAChBA,KADgB,CAEhCU,QAAQ,CAACF,eAAe,CAACM,EAAD,CAAKd,KAAL,CAAYC,KAAZ,CAAmB,IAAnB,CAAhB,CAAR,CACH,CANoC,sDAAN,gEAAhC,CAWP,MAAO,IAAMc,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACf,KAAD,CAAQgB,QAAR,CAAkBC,UAAlB,kGAAiC,kBAAOP,QAAP,kKACzChB,CAAAA,OAAO,CAACO,KAAR,CAAcD,KAAd,CAAqBgB,QAArB,CAA+BC,UAA/B,CADyC,QAC1DL,QAD0D,gBAE9D,GAAIA,QAAQ,CAACL,IAAT,CAAcM,UAAd,GAA6B,CAAjC,CAAoCH,QAAQ,CAACD,uBAAuB,EAAxB,CAAR,CAApC,IACK,CACGS,OADH,CACaN,QAAQ,CAACL,IAAT,CAAcY,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCR,QAAQ,CAACL,IAAT,CAAcY,QAAd,CAAuB,CAAvB,CAApC,CAAgE,YAD7E,CAEDT,QAAQ,CAACf,UAAU,CAAC,OAAD,CAAU,CAAC0B,MAAM,CAAEH,OAAT,CAAV,CAAX,CAAR,CACH,CAN6D,wDAAjC,kEAA1B,CASP,MAAO,IAAMI,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,EAAM,CACpC,gGAAO,kBAAOZ,QAAP,0JACkBhB,CAAAA,OAAO,CAAC6B,MAAR,EADlB,QACCX,QADD,gBAEHF,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CAFG,wDAAP,iEAIH,CALM,CAOP,cAAeL,CAAAA,WAAf","sourcesContent":["import {authAPI} from \"../api/api\";\r\nimport {stopSubmit} from \"redux-form\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nexport const SET_AUTH_USER_DATA = 'SET-AUTH-USER-DATA'\r\n\r\n\r\nlet initialState = {\r\n    userID: null,\r\n    email: null,\r\n    login: null,\r\n    isAuth: false\r\n}\r\n\r\nlet authReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_AUTH_USER_DATA: {\r\n            return {\r\n                ...state,\r\n                ...action.data,\r\n                isAuth: action.isAuth\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setAuthUserData = (userID, email, login, isAuth) => ({\r\n    type: SET_AUTH_USER_DATA,\r\n    data: {userID, email, login},\r\n    isAuth\r\n})\r\nexport const setAuthUserThunkCreator = () => async (dispatch) => {\r\n    {\r\n        let response = await authAPI.setAuthorizedProfile()\r\n        if (response.data.resultCode === 0) {\r\n            let {id, login, email} = response.data.data;\r\n            dispatch(setAuthUserData(id, email, login, true));\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport const loginThunkCreator = (email, password, rememberMe) => async (dispatch) => {\r\n    let response = await authAPI.login(email, password, rememberMe)\r\n    if (response.data.resultCode === 0) dispatch(setAuthUserThunkCreator())\r\n    else {\r\n        let message = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\";\r\n        dispatch(stopSubmit(\"login\", {_error: message}));\r\n    }\r\n\r\n}\r\nexport const logoutThunkCreator = () => {\r\n    return async (dispatch) => {\r\n        let response = await authAPI.logout()\r\n        dispatch(setAuthUserData(null, null, null, false))\r\n    }\r\n}\r\n\r\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}